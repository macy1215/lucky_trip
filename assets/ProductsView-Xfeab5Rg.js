import{M as U}from"./modal-0mLGR50g.js";import{_ as P,A as M,o as a,c as i,b as t,e as d,D as c,F as V,u as w,t as m,K as C,L as _,x as I,f,r as h,d as b,C as y}from"./index-tObUnU7K.js";import{P as N}from"./PaginationView-8M4GUU7o.js";import{S as T}from"./sweetalert2.all-gZkmNDgu.js";import"./selector-engine-_8PpKhyI.js";var D={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:x,VITE_NAME:k}=D,R={props:["tempProduct","isNew","clearInput","getProducts","description"],data(){return{productModal:null,data:""}},methods:{showModal(){this.productModal.show()},hideModal(){this.productModal.hide()},updateProduct(){let l=`${x}/api/${k}/admin/product`,e="post";this.isNew||(l=`${x}/api/${k}/admin/product/${this.tempProduct.id}`,e="put"),M[e](l,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.hideModal(),this.$emit("update")}).catch(o=>{alert(o.response.data.message)})},addschedules(){console.log(this.tempProduct.schedule[0]);let l=this.tempProduct.schedule;Array.isArray(l)||(l=[l]),l.push(""),this.$emit("update:tempProduct",{...this.tempProduct,schedule:l})}},mounted(){this.productModal=new U(this.$refs.productModal,{keyboard:!1,backdrop:"static"})}},A={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},S={class:"modal-dialog modal-xl"},$={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},O={id:"productModalLabel",class:"modal-title"},F={key:0},j={key:1},K=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},z={class:"row"},G={class:"col-sm-12"},H={class:"row mb-2"},J={class:"mb-3 text-start col-sm-6"},Q=t("label",{for:"imagesUrl",class:"form-label h5"},"主要圖片",-1),W=["src"],X={class:"col-sm-6"},Y=t("h5",{class:"text-start h5"},"多圖新增",-1),Z={key:0},tt={class:"form-group d-flex mb-3 align-items-center"},et=["for"],ot=["id","onUpdate:modelValue"],st=["src"],lt={key:0,class:"my-2"},dt={key:1},at={key:1},it={class:"col-sm-12"},nt={class:"mb-3 text-start"},ct=t("label",{for:"title",class:"form-label"},"旅遊方案標題",-1),rt={class:"row text-start"},ut={class:"mb-3 col-md-6"},mt=t("label",{for:"category",class:"form-label"},"旅遊類型",-1),pt={class:"mb-3 col-md-6"},_t=t("label",{for:"unit",class:"form-label"},"單位",-1),ht={class:"row text-start"},bt={class:"mb-3 col-md-6"},ft=t("label",{for:"origin_price",class:"form-label"},"原價",-1),vt={class:"mb-3 col-md-6"},Pt=t("label",{for:"price",class:"form-label"},"售價",-1),gt={class:"row text-start"},yt={class:"mb-3 col-md-6"},xt=t("label",{for:"area",class:"form-label"},"地區",-1),kt=I('<option selected>請選擇地區</option><option value="北區">北部</option><option value="中部">中部</option><option value="南部">南部</option><option value="東部">東部</option>',5),Ut=[kt],Mt={class:"mb-3 col-md-6"},Vt=t("label",{for:"area",class:"form-label"},"建議使用交通工具",-1),wt={class:"d-lg-inline-flex flex-row align-items-center mt-2"},Et={class:"form-check me-3 form-check-inline"},Lt=t("label",{class:"form-check-label",for:"walk"}," 雙腳萬能 ",-1),Ct={class:"form-check me-3 form-check-inline"},It=t("label",{class:"form-check-label",for:"Intercitybus"}," 包車(租賃、遊覽車) ",-1),Nt={class:"form-check form-check-inline"},Tt=t("label",{class:"form-check-label",for:"publictrans"}," 大眾交通(火車、公車、捷運等) ",-1),Dt={class:"mb-3 text-start"},Rt=t("label",{for:"description",class:"form-label"},"旅遊簡介說明",-1),At={class:"mb-3 text-start"},St=t("label",{for:"description",class:"form-label"},"旅遊行程文字說明",-1),$t={class:"mb-3 text-start"},Bt=t("label",{for:"content",class:"form-label"},"餐點內容",-1),Ot={class:"mb-3 text-start"},Ft=t("label",{for:"content",class:"form-label"},"發布集合地點",-1),jt={class:"mb-3 text-start"},Kt=t("label",{for:"content",class:"form-label"},"包車",-1),qt={class:"form-check ms-3 form-check-inline"},zt=t("label",{class:"form-check-label",for:"needcar"}," 可包車 ",-1),Gt={class:"mb-3 text-start"},Ht=t("label",{for:"feeincluded",class:"form-label"},"費用包含",-1),Jt={class:"d-flex"},Qt={class:"mb-3 text-start w-25"},Wt=t("label",{for:"peoplemin",class:"form-label"},"最少成行人數",-1),Xt={class:"mb-3 ms-4 text-start w-25"},Yt=t("label",{for:"registpeople",class:"form-label"},"可報名人數",-1),Zt={class:"mb-3 text-start"},te={class:"form-check"},ee=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),oe={class:"modal-footer"},se=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function le(l,e,o,g,u,r){return a(),i("div",A,[t("div",S,[t("div",$,[t("div",B,[t("h5",O,[o.isNew?(a(),i("span",F,"新增產品")):(a(),i("span",j,"編輯產品"))]),K]),t("div",q,[t("div",z,[t("div",G,[t("div",H,[t("div",J,[Q,d(t("input",{type:"text",id:"imageUrl",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s),placeholder:"請輸入圖片連結"},null,512),[[c,o.tempProduct.imageUrl]]),t("img",{class:"img-fluid mt-3",src:o.tempProduct.imageUrl,alt:""},null,8,W)]),t("div",X,[Y,Array.isArray(o.tempProduct.imagesUrl)?(a(),i("div",Z,[(a(!0),i(V,null,w(o.tempProduct.imagesUrl,(s,p)=>(a(),i("div",{key:p},[t("div",tt,[t("label",{for:`imageUrl${p}`,class:"form-label col-1 mb-0"},"網址"+m(p+1),9,et),d(t("input",{id:`imageUrl${p}`,type:"text",class:"form-control ms-2","onUpdate:modelValue":v=>o.tempProduct.imagesUrl[p]=v,placeholder:"請輸入圖片連結"},null,8,ot),[[c,o.tempProduct.imagesUrl[p]]])]),t("div",null,[t("img",{class:"img-fluid",src:s,alt:""},null,8,st)])]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl.at(-1).trim()?(a(),i("div",lt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=s=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(a(),i("div",dt,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):(a(),i("div",at,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=s=>o.tempProduct.imagesUrl=[""])}," 新增圖片 ")]))])])]),t("div",it,[t("div",nt,[ct,d(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.title=s)},null,512),[[c,o.tempProduct.title]])]),t("div",rt,[t("div",ut,[mt,d(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.category=s)},null,512),[[c,o.tempProduct.category]])]),t("div",pt,[_t,d(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.unit=s)},null,512),[[c,o.tempProduct.unit]])])]),t("div",ht,[t("div",bt,[ft,d(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.origin_price=s)},null,512),[[c,o.tempProduct.origin_price]])]),t("div",vt,[Pt,d(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.price=s)},null,512),[[c,o.tempProduct.price]])])]),t("div",gt,[t("div",yt,[xt,d(t("select",{class:"form-select","aria-label":"Default select","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.area=s)},Ut,512),[[C,o.tempProduct.area]])]),t("div",Mt,[Vt,t("div",wt,[t("div",Et,[d(t("input",{class:"form-check-input",type:"checkbox",value:"雙腳萬能",id:"walk","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.is_walk=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_walk]]),Lt]),t("div",Ct,[d(t("input",{class:"form-check-input",type:"checkbox",value:"包車",id:"Intercitybus","onUpdate:modelValue":e[11]||(e[11]=s=>o.tempProduct.is_intercitybus=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_intercitybus]]),It]),t("div",Nt,[d(t("input",{class:"form-check-input",type:"checkbox",value:"大眾交通",id:"publictrans","onUpdate:modelValue":e[12]||(e[12]=s=>o.tempProduct.is_publictrans=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_publictrans]]),Tt])])])]),t("div",Dt,[Rt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"旅遊簡介說明","onUpdate:modelValue":e[13]||(e[13]=s=>o.tempProduct.description=s)},`
                    `,512),[[c,o.tempProduct.description]])]),t("div",At,[St,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"旅遊行程文字說明","onUpdate:modelValue":e[14]||(e[14]=s=>o.tempProduct.schedule=s)},`
                    `,512),[[c,o.tempProduct.schedule]])]),t("div",$t,[Bt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入注意事項","onUpdate:modelValue":e[15]||(e[15]=s=>o.tempProduct.content=s)},`
                    `,512),[[c,o.tempProduct.content]])]),t("div",Ot,[Ft,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入注意事項","onUpdate:modelValue":e[16]||(e[16]=s=>o.tempProduct.place=s)},`
                    `,512),[[c,o.tempProduct.place]])]),t("div",jt,[Kt,t("div",qt,[d(t("input",{class:"form-check-input",type:"checkbox",value:"可包車",id:"needcar","onUpdate:modelValue":e[17]||(e[17]=s=>o.tempProduct.need_car=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.need_car]]),zt])]),t("div",Gt,[Ht,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入費用內容","onUpdate:modelValue":e[18]||(e[18]=s=>o.tempProduct.feeincluded=s)},`
                    `,512),[[c,o.tempProduct.feeincluded]])]),t("div",Jt,[t("div",Qt,[Wt,d(t("input",{id:"peoplemin",type:"number",min:"0",class:"form-control",placeholder:"請輸入最少成行人數","onUpdate:modelValue":e[19]||(e[19]=s=>o.tempProduct.minpeople=s)},null,512),[[c,o.tempProduct.minpeople]])]),t("div",Xt,[Yt,d(t("input",{id:"registpeople",type:"number",min:"0",class:"form-control",placeholder:"請輸入最多可報名人數","onUpdate:modelValue":e[20]||(e[20]=s=>o.tempProduct.regist=s)},null,512),[[c,o.tempProduct.regist]])])]),t("div",Zt,[t("div",te,[d(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[21]||(e[21]=s=>o.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_enabled]]),ee])])])])]),t("div",oe,[se,t("button",{type:"button",class:"btn btn-primary",onClick:e[22]||(e[22]=(...s)=>r.updateProduct&&r.updateProduct(...s))}," 確認 ")])])])],512)}const de=P(R,[["render",le]]);var ae={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:ie,VITE_NAME:ne}=ae,ce={props:["tempProduct","getProducts"],data(){return{delProductModal:null}},methods:{showModal(){this.delProductModal.show()},hideModal(){this.delProductModal.hide()},deleteProduct(){const l=`${ie}/api/${ne}/admin/product/${this.tempProduct.id}`;M.delete(l,{data:this.tempProduct}).then(e=>{alert(e.data.message),this.hideModal(),this.$emit("update")}).catch(e=>{alert(e.response.data.message)})}},mounted(){this.delProductModal=new U(this.$refs.delProductModal,{keyboard:!1,backdrop:"static"})}},re={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ue={class:"modal-dialog"},me={class:"modal-content border-0"},pe=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),_e={class:"modal-body text-start"},he={class:"text-danger"},be={class:"fw-bold"},fe=t("div",{class:"mt-2"}," (刪除後將無法恢復)。 ",-1),ve={class:"modal-footer"},Pe=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ge(l,e,o,g,u,r){return a(),i("div",re,[t("div",ue,[t("div",me,[pe,t("div",_e,[f(" 是否刪除 "),t("strong",he,[t("span",be,m(o.tempProduct.title),1)]),f(" 方案 "),fe]),t("div",ve,[Pe,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...s)=>r.deleteProduct&&r.deleteProduct(...s))}," 確認刪除 ")])])])],512)}const ye=P(ce,[["render",ge]]);var xe={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:ke,VITE_NAME:Ue}=xe,Me={components:{ModalCompanent:de,ModalDelComponent:ye,Pagination:N},data(){return{products:[],isLoading:!1,fullpage:!1,tempProduct:{imagesUrl:[],minpeople:"",regist:"",schedule:[]},isNew:!1,pagination:{}}},mounted(){this.getProducts()},methods:{getProducts(l=1){this.isLoading=!0;const e=`${ke}/api/${Ue}/admin/products?page=${l}`;this.$http.get(e).then(o=>{this.products=o.data.products,this.pagination=o.data.pagination,this.isLoading=!1,T.fire({position:"top-end",icon:"success",title:"成功取得產品資訊",showConfirmButton:!1,timer:1500})}).catch(o=>{console.log(o),this.$router.push("/login")})},openModal(l,e){l==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.modal.showModal()):l==="edit"?(this.tempProduct={...e},this.isNew=!1,console.log(this.tempProduct),this.$refs.modal.showModal()):l==="delete"&&(this.tempProduct={...e},this.$refs.delModal.showModal())},clearInput(){this.tempProduct={imageUrl:""}},deleteProduct(){const l=`${this.apiUrl}/api/${this.path}/admin/product/${this.tempProduct.id}`;this.$http.delete(l,{data:this.tempProduct}).then(e=>{alert(e.data.message),this.$refs.dModal.closeProduct(),this.getData()}).catch(e=>{alert(e.data.message)})}}},Ve={class:"vl-parent"},we={class:"container"},Ee={class:"row justify-content-between"},Le=t("h2",{class:"text-primary mb-3 h2 text-start col-6"},"方案列表",-1),Ce={class:"text-end col-6"},Ie={class:"table table-hover border rounded rounded-3"},Ne=t("thead",null,[t("tr",null,[t("th",{scope:"col"}," 上架日期"),t("th",{colspan:"1",scope:"col"},"方案類別"),t("th",{colspan:"1",scope:"col"},"方案標題"),t("th",{colspan:"1",scope:"col"},"原始價格"),t("th",{colspan:"1",scope:"col"},"上線價格"),t("th",{colspan:"1",scope:"col"},"啟用狀態"),t("th",{colspan:"1",scope:"col"},"編輯")])],-1),Te={scope:"row"},De={key:0,class:"text-success"},Re={key:1},Ae={class:"btn-group btn-group-sm"},Se=["onClick"],$e={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Be=["onClick"],Oe={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function Fe(l,e,o,g,u,r){const s=h("VueLoading"),p=h("Pagination"),v=h("ModalCompanent"),E=h("ModalDelComponent");return a(),i("div",Ve,[b(s,{active:u.isLoading,"onUpdate:active":e[0]||(e[0]=n=>u.isLoading=n),loader:"bars","is-full-page":u.fullpage},null,8,["active","is-full-page"]),t("div",we,[t("div",Ee,[Le,t("div",Ce,[t("button",{type:"button",class:"btn btn-primary text-white fw-bold",onClick:e[1]||(e[1]=n=>r.openModal("new"))},"新增方案")])]),t("table",Ie,[Ne,t("tbody",null,[(a(!0),i(V,null,w(u.products,n=>(a(),i("tr",{key:n.id,class:"align-middle"},[t("th",Te,m(n.num),1),t("td",null,m(n.category),1),t("td",null,m(n.title),1),t("td",null,"NT$ "+m(n.origin_price)+"/"+m(n.unit),1),t("td",null,"NT$ "+m(n.price)+"/"+m(n.unit),1),t("td",null,[n.is_enabled?(a(),i("span",De,"啟用")):(a(),i("span",Re,"不啟用"))]),t("td",null,[t("div",Ae,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:L=>r.openModal("edit",n)},[n.num===0?(a(),i("span",$e)):y("",!0),f(" 編輯內容 ")],8,Se),t("button",{type:"button",class:"btn btn-outline-danger",onClick:L=>r.openModal("delete",n)},[n.num===0?(a(),i("span",Oe)):y("",!0),f(" 刪除內容 ")],8,Be)])])]))),128))])]),b(p,{pagination:u.pagination,onEmitPages:r.getProducts},null,8,["pagination","onEmitPages"])]),b(v,{ref:"modal","temp-product":u.tempProduct,"is-new":u.isNew,"clear-input":r.clearInput,onUpdate:r.getProducts},null,8,["temp-product","is-new","clear-input","onUpdate"]),b(E,{ref:"delModal","temp-product":u.tempProduct,onUpdate:r.getProducts},null,8,["temp-product","onUpdate"])])}const He=P(Me,[["render",Fe]]);export{He as default};

import{S as h}from"./sweetalert2.all-D5HYM6X6.js";import{M as x}from"./modal-31Vg7DH1.js";import{_ as y,J as E,o as l,c as n,b as e,t as d,e as _,H as u,E as g,F as f,x as v,V as $,f as O,r as m,d as b}from"./index-9V4W6d-f.js";import{P as C}from"./PaginationView-_I69zgDG.js";import"./selector-engine-z0X_0PqM.js";var L={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:U,VITE_NAME:D}=L,S={props:["tempOrder","getOrders"],data(){return{orderEdittModal:null,order:{}}},methods:{showModal(){this.orderEdittModal.show()},hideModal(){this.orderEdittModal.hide()},updateOrder(){const i=`${U}/api/${D}/admin/order/${this.tempOrder.id}`;E["put"](i,{data:this.tempOrder}).then(r=>{this.$emit("update"),h.fire({icon:"success",title:r.data.message,showConfirmButton:!1,timer:1500}),this.hideModal()}).catch(r=>{h.fire({icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500})})}},watch:{tempOrder(){this.order=this.tempOrder}},mounted(){this.orderEdittModal=new x(this.$refs.OrderEditModal,{keyboard:!1,backdrop:"static"})}},T={id:"OrderEditModal",ref:"OrderEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"OrderEditModal","aria-hidden":"true"},I={class:"modal-dialog modal-xl"},R={class:"modal-content border-0"},P={class:"modal-header bg-dark text-white"},B={id:"OrderEditModal",class:"modal-title"},N=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),A={class:"modal-body text-start"},j={class:"h5 fw-bold"},q={class:"h5 fw-bold"},z=e("hr",null,null,-1),F={class:"row"},H={class:"col-sm-12"},J={class:"row mb-2"},G={key:0,class:"row"},K={class:"col-md-6 mb-4"},Q=e("label",{for:"people",class:"form-label"},"訂購人姓名",-1),W={class:"col-md-6 mb-4"},X=e("label",{for:"people",class:"form-label"},"訂單電話",-1),Y={class:"col-md-6 mb-4"},Z=e("label",{for:"people",class:"form-label"},"訂單電子郵件",-1),ee={class:"col-md-6 mb-4"},te=e("label",{for:"people",class:"form-label"},"訂單電子郵件",-1),se={class:"col-md-12 mb-4"},oe=e("label",{for:"people",class:"form-label"},"訂單留言",-1),de={class:"col-md-12 mb-1"},re=e("label",{for:"people",class:"form-label mb-2"},"付款狀態",-1),le={key:0,class:"text-success"},ne={key:1,class:"text-danger fw-bold"},ae=e("hr",null,null,-1),ie={class:"row mt-2"},ce={class:"col-lg-12"},pe={key:0,class:"mb-2"},_e={class:"table table-hover border rounded rounded-3"},ue=e("thead",null,[e("tr",{class:"text-center"},[e("th",{scope:"col"},"編號"),e("th",{colspan:"1",scope:"col"},"品項圖"),e("th",{colspan:"1",scope:"col"},"品項標題"),e("th",{colspan:"1",scope:"col",class:"text-end"}," 品項價格 ")])],-1),he={class:"ps-3 py-2 text-center"},me={scope:"row"},be={class:"d-flex justify-content-center"},fe={style:{width:"180px"}},ge={class:"text-end"},Oe={class:"text-end fw-bold me-2"},ve={class:"modal-footer"},ye=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Me(i,t,r,M,s,c){return l(),n("div",T,[e("div",I,[e("div",R,[e("div",P,[e("h5",B,[e("span",null,"編輯訂單 "+d(r.tempOrder.id),1)]),N]),e("div",A,[e("div",j,"訂單編號："+d(r.tempOrder.id),1),e("div",q," 訂單日期： "+d(new Date(s.order.create_at*1e3).toLocaleDateString()),1),z,e("div",F,[e("div",H,[e("div",J,[s.order.user?(l(),n("div",G,[e("div",K,[Q,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=o=>s.order.user.name=o),disabled:""},null,512),[[u,s.order.user.name]])]),e("div",W,[X,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=o=>s.order.user.tel=o),disabled:""},null,512),[[u,s.order.user.tel]])]),e("div",Y,[Z,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=o=>s.order.user.email=o),disabled:""},null,512),[[u,s.order.user.email]])]),e("div",ee,[te,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=o=>s.order.user.address=o),disabled:""},null,512),[[u,s.order.user.address]])]),e("div",se,[oe,_(e("textarea",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.order.message=o),disabled:""},`
                    `,512),[[u,s.order.message]])]),e("div",de,[re,e("div",null,[s.order.is_paid?(l(),n("span",le,"已付款")):(l(),n("span",ne,"未付款"))])])])):g("",!0)]),ae,e("div",ie,[e("div",ce,[r.tempOrder&&r.tempOrder.products?(l(),n("div",pe," 訂單內容 ("+d(Object.keys(r.tempOrder.products).length)+") ",1)):g("",!0),e("table",_e,[ue,e("tbody",he,[(l(!0),n(f,null,v(s.order.products,o=>(l(),n("tr",{key:o.id,class:"align-middle"},[e("th",me,d(Object.keys(s.order.products).length),1),e("td",be,[e("div",fe,[e("div",{class:"rounded",style:$([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.product.imageUrl})`}])},null,4)])]),e("td",null,d(o.product.title)+" x "+d(o.qty)+" / "+d(o.product.unit),1),e("td",ge,d(o.total)+" 元",1)]))),128))])]),e("p",Oe,"總金額："+d(s.order.total),1)])])])])]),e("div",ve,[ye,e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...o)=>c.updateOrder&&c.updateOrder(...o))}," 確認 ")])])])],512)}const xe=y(S,[["render",Me]]);var Ee={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:we,VITE_NAME:ke}=Ee,Ve={props:["tempOrder","getOrders"],data(){return{delOrderModal:null}},methods:{showModal(){this.delOrderModal.show()},hideModal(){this.delOrderModal.hide()},deleteOrder(){const i=`${we}/api/${ke}/admin/order/${this.tempOrder.id}`;E.delete(i,{data:this.tempOrder}).then(t=>{this.$emit("update"),this.hideModal(),h.fire({icon:"success",title:t.data.message,showConfirmButton:!1,timer:1500})}).catch(t=>{h.fire({icon:"success",title:t.response.data.message,showConfirmButton:!1,timer:1500})})}},mounted(){this.delOrderModal=new x(this.$refs.delOrderModal,{keyboard:!1,backdrop:"static"})}},$e={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Ce={class:"modal-dialog"},Le={class:"modal-content border-0"},Ue={class:"modal-header bg-danger text-white"},De={id:"delProductModalLabel",class:"modal-title"},Se=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Te={class:"modal-body text-start"},Ie={class:"text-danger"},Re={class:"fw-bold"},Pe=e("div",{class:"mt-2"},"(刪除後將無法恢復)。",-1),Be={class:"modal-footer"},Ne=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ae(i,t,r,M,s,c){return l(),n("div",$e,[e("div",Ce,[e("div",Le,[e("div",Ue,[e("h5",De,[e("span",null,"訂單編號"+d(r.tempOrder.id),1)]),Se]),e("div",Te,[O(" 是否刪除訂單編號為 "),e("strong",Ie,[e("span",Re,d(r.tempOrder.id),1)]),O(" 訂單？ "),Pe]),e("div",Be,[Ne,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...o)=>c.deleteOrder&&c.deleteOrder(...o))}," 確認刪除 ")])])])],512)}const je=y(Ve,[["render",Ae]]),qe={components:{OrderEditCompanent:xe,OrdelDelComponent:je,Pagination:C},data(){return{orders:[],tempOrder:{},pagination:{},isLoading:!1}},mounted(){this.getOrders(1)},methods:{getOrders(i=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/lucky_trip/admin/orders?page=${i}`;this.$http.get(t).then(r=>{this.orders=r.data.orders,this.pagination=r.data.pagination,this.isLoading=!1}).catch(r=>{h.fire({icon:"error",title:r.response.data.message})})},openModal(i,t){i==="edit"?(this.tempOrder={...t},this.status=!1,this.$refs.orderEditModal.showModal()):i==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.showModal())}}},ze={class:"container"},Fe=e("div",{class:"row justify-content-between"},[e("h2",{class:"text-primary mb-3 h2 text-start col-6"},"訂單列表")],-1),He={class:"table table-hover border rounded rounded-3 table-responsive"},Je=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",{colspan:"1",scope:"col"},"訂單編號"),e("th",{colspan:"1",scope:"col"},"成立時間"),e("th",{colspan:"1",scope:"col"},"訂單內容"),e("th",{colspan:"1",scope:"col"},"訂購人"),e("th",{colspan:"1",scope:"col"},"聯絡電話"),e("th",{colspan:"1",scope:"col"},"合計"),e("th",{colspan:"1",scope:"col"},"付款狀態"),e("th",{colspan:"1",scope:"col"},"編輯")])],-1),Ge={scope:"row"},Ke={class:"ps-0 mb-0"},Qe={key:0,class:"text-success"},We={key:1,class:"text-danger"},Xe={class:"btn-group btn-group-sm"},Ye=["onClick"],Ze={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},et=["onClick"],tt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function st(i,t,r,M,s,c){const o=m("VueLoading"),w=m("Pagination"),k=m("OrderEditCompanent"),V=m("OrdelDelComponent");return l(),n(f,null,[b(o,{active:s.isLoading,"onUpdate:active":t[0]||(t[0]=a=>s.isLoading=a)},null,8,["active"]),e("div",ze,[Fe,e("table",He,[Je,e("tbody",null,[(l(!0),n(f,null,v(s.orders,a=>(l(),n("tr",{key:a.id,class:"align-middle"},[e("th",Ge,d(a.id),1),e("td",null,d(new Date(a.create_at*1e3).toLocaleDateString()),1),e("td",null,[e("ul",Ke,[(l(!0),n(f,null,v(a.products,p=>(l(),n("li",{key:p.product_is},d(p.product.title)+" | "+d(p.qty)+"人 ",1))),128))])]),e("td",null,d(a.user.name),1),e("td",null,d(a.user.tel),1),e("td",null,d(a.total),1),e("td",null,[a.is_paid?(l(),n("span",Qe,"已付款")):(l(),n("span",We,"未付款"))]),e("td",null,[e("div",Xe,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:p=>c.openModal("edit",a)},[a.num===0?(l(),n("span",Ze)):g("",!0),O(" 編輯 ")],8,Ye),e("button",{type:"button",class:"btn btn-outline-danger",onClick:p=>c.openModal("delete",a)},[a.num===0?(l(),n("span",tt)):g("",!0),O(" 刪除 ")],8,et)])])]))),128))])]),b(w,{pagination:s.pagination,onEmitPages:c.getOrders},null,8,["pagination","onEmitPages"])]),b(k,{ref:"orderEditModal","temp-order":s.tempOrder,onUpdate:c.getOrders},null,8,["temp-order","onUpdate"]),b(V,{ref:"delOrderModal","temp-order":s.tempOrder,onUpdate:c.getOrders},null,8,["temp-order","onUpdate"])],64)}const at=y(qe,[["render",st]]);export{at as default};

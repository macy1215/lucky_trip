import{M,P as C}from"./PaginationView-eKQ4DhgC.js";import{_ as P,z as U,o as a,c as i,a as t,F as V,u as w,y as m,d,B as r,H as I,I as _,x as N,e as f,r as h,b,A as y}from"./index-uHVYxXOi.js";import{S as T}from"./sweetalert2.all-LWOd0MdR.js";import"./selector-engine-pKGNWdRj.js";var R={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:x,VITE_NAME:k}=R,$={props:["tempProduct","isNew","clearInput","getProducts","description"],data(){return{productModal:null,data:""}},methods:{showModal(){this.productModal.show()},hideModal(){this.productModal.hide()},updateProduct(){let l=`${x}/api/${k}/admin/product`,e="post";this.isNew||(l=`${x}/api/${k}/admin/product/${this.tempProduct.id}`,e="put"),U[e](l,{data:this.tempProduct}).then(o=>{alert(o.data.message),this.hideModal(),this.$emit("update")}).catch(o=>{alert(o.response.data.message)})},addschedules(){console.log(this.tempProduct.schedule[0]);let l=this.tempProduct.schedule;Array.isArray(l)||(l=[l]),l.push(""),this.$emit("update:tempProduct",{...this.tempProduct,schedule:l})},uploadFile(){}},mounted(){this.productModal=new M(this.$refs.productModal,{keyboard:!1,backdrop:"static"})}},A={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl"},S={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},O={id:"productModalLabel",class:"modal-title"},F={key:0},j={key:1},z=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},q={class:"row"},G={class:"col-sm-12"},J={class:"row mb-2"},K={class:"mb-3 text-start col-sm-6"},Q=t("label",{for:"imagesUrl",class:"form-label h5"},"主要圖片",-1),W=["v-model"],X=["src"],Y={class:"col-sm-6"},Z=t("h5",{class:"text-start h5"},"多圖新增",-1),tt={key:0},et={class:"form-group d-flex mb-3 align-items-center"},ot=["for"],st=["id","onUpdate:modelValue"],lt=["src"],dt={key:0,class:"my-2"},at={key:1},it={key:1},nt={class:"col-sm-12"},ct={class:"mb-3 text-start"},rt=t("label",{for:"title",class:"form-label"},"旅遊方案標題",-1),ut={class:"row text-start"},mt={class:"mb-3 col-md-6"},pt=t("label",{for:"category",class:"form-label"},"旅遊類型",-1),_t={class:"mb-3 col-md-6"},ht=t("label",{for:"unit",class:"form-label"},"單位",-1),bt={class:"row text-start"},ft={class:"mb-3 col-md-6"},vt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),Pt={class:"mb-3 col-md-6"},gt=t("label",{for:"price",class:"form-label"},"售價",-1),yt={class:"row text-start"},xt={class:"mb-3 col-md-6"},kt=t("label",{for:"area",class:"form-label"},"地區",-1),Mt=N('<option selected>請選擇地區</option><option value="北區">北部</option><option value="中部">中部</option><option value="南部">南部</option><option value="東部">東部</option>',5),Ut=[Mt],Vt={class:"mb-3 col-md-6"},wt=t("label",{for:"area",class:"form-label"},"建議使用交通工具",-1),Et={class:"d-lg-inline-flex flex-row align-items-center mt-2"},Lt={class:"form-check me-3 form-check-inline"},Ct=t("label",{class:"form-check-label",for:"walk"}," 雙腳萬能 ",-1),It={class:"form-check me-3 form-check-inline"},Nt=t("label",{class:"form-check-label",for:"Intercitybus"}," 包車(租賃、遊覽車) ",-1),Tt={class:"form-check form-check-inline"},Rt=t("label",{class:"form-check-label",for:"publictrans"}," 大眾交通(火車、公車、捷運等) ",-1),$t={class:"mb-3 text-start"},At=t("label",{for:"description",class:"form-label"},"旅遊簡介說明",-1),Dt={class:"mb-3 text-start"},St=t("label",{for:"description",class:"form-label"},"旅遊行程文字說明",-1),Bt={class:"mb-3 text-start"},Ot=t("label",{for:"content",class:"form-label"},"注意事項",-1),Ft={class:"mb-3 text-start"},jt=t("label",{for:"feeincluded",class:"form-label"},"費用包含",-1),zt={class:"d-flex"},Ht={class:"mb-3 text-start w-25"},qt=t("label",{for:"peoplemin",class:"form-label"},"最少成行人數",-1),Gt={class:"mb-3 ms-4 text-start w-25"},Jt=t("label",{for:"registpeople",class:"form-label"},"可報名人數",-1),Kt={class:"mb-3 text-start"},Qt=t("label",{for:"content",class:"form-label"},"取消退費政策",-1),Wt={class:"mb-3 text-start"},Xt={class:"form-check"},Yt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Zt={class:"modal-footer"},te=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ee(l,e,o,g,u,c){return a(),i("div",A,[t("div",D,[t("div",S,[t("div",B,[t("h5",O,[o.isNew?(a(),i("span",F,"新增產品")):(a(),i("span",j,"編輯產品"))]),z]),t("div",H,[t("div",q,[t("div",G,[t("div",J,[t("div",K,[Q,t("input",{type:"text",id:"imageUrl",class:"form-control","v-model":o.tempProduct.imageUrl,placeholder:"請輸入圖片連結"},null,8,W),t("img",{class:"img-fluid mt-3",src:o.tempProduct.imageUrl,alt:""},null,8,X)]),t("div",Y,[Z,Array.isArray(o.tempProduct.imagesUrl)?(a(),i("div",tt,[(a(!0),i(V,null,w(o.tempProduct.imagesUrl,(s,p)=>(a(),i("div",{key:p},[t("div",et,[t("label",{for:`imageUrl${p}`,class:"form-label col-1 mb-0"},"網址"+m(p+1),9,ot),d(t("input",{id:`imageUrl${p}`,type:"text",class:"form-control ms-2","onUpdate:modelValue":v=>o.tempProduct.imagesUrl[p]=v,placeholder:"請輸入圖片連結"},null,8,st),[[r,o.tempProduct.imagesUrl[p]]])]),t("div",null,[t("img",{class:"img-fluid",src:s,alt:""},null,8,lt)])]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl.at(-1).trim()?(a(),i("div",dt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[0]||(e[0]=s=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(a(),i("div",at,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[1]||(e[1]=s=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):(a(),i("div",it,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>o.tempProduct.imagesUrl=[""])}," 新增圖片 ")]))])])]),t("div",nt,[t("div",ct,[rt,d(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.title=s)},null,512),[[r,o.tempProduct.title]])]),t("div",ut,[t("div",mt,[pt,d(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.category=s)},null,512),[[r,o.tempProduct.category]])]),t("div",_t,[ht,d(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.unit=s)},null,512),[[r,o.tempProduct.unit]])])]),t("div",bt,[t("div",ft,[vt,d(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.origin_price=s)},null,512),[[r,o.tempProduct.origin_price]])]),t("div",Pt,[gt,d(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.price=s)},null,512),[[r,o.tempProduct.price]])])]),t("div",yt,[t("div",xt,[kt,d(t("select",{class:"form-select","aria-label":"Default select","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.area=s)},Ut,512),[[I,o.tempProduct.area]])]),t("div",Vt,[wt,t("div",Et,[t("div",Lt,[d(t("input",{class:"form-check-input",type:"checkbox",value:"雙腳萬能",id:"walk","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.is_walk=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_walk]]),Ct]),t("div",It,[d(t("input",{class:"form-check-input",type:"checkbox",value:"包車",id:"Intercitybus","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.is_intercitybus=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_intercitybus]]),Nt]),t("div",Tt,[d(t("input",{class:"form-check-input",type:"checkbox",value:"大眾交通",id:"publictrans","onUpdate:modelValue":e[11]||(e[11]=s=>o.tempProduct.is_publictrans=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_publictrans]]),Rt])])])]),t("div",$t,[At,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"旅遊簡介說明","onUpdate:modelValue":e[12]||(e[12]=s=>o.tempProduct.description=s)},`
                    `,512),[[r,o.tempProduct.description]])]),t("div",Dt,[St,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"旅遊行程文字說明","onUpdate:modelValue":e[13]||(e[13]=s=>o.tempProduct.schedule=s)},`
                    `,512),[[r,o.tempProduct.schedule]])]),t("div",Bt,[Ot,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入注意事項","onUpdate:modelValue":e[14]||(e[14]=s=>o.tempProduct.content=s)},`
                    `,512),[[r,o.tempProduct.content]])]),t("div",Ft,[jt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入費用內容","onUpdate:modelValue":e[15]||(e[15]=s=>o.tempProduct.feeincluded=s)},`
                    `,512),[[r,o.tempProduct.feeincluded]])]),t("div",zt,[t("div",Ht,[qt,d(t("input",{id:"peoplemin",type:"number",min:"0",class:"form-control",placeholder:"請輸入最少成行人數","onUpdate:modelValue":e[16]||(e[16]=s=>o.tempProduct.minpeople=s)},null,512),[[r,o.tempProduct.minpeople]])]),t("div",Gt,[Jt,d(t("input",{id:"registpeople",type:"number",min:"0",class:"form-control",placeholder:"請輸入最多可報名人數","onUpdate:modelValue":e[17]||(e[17]=s=>o.tempProduct.regist=s)},null,512),[[r,o.tempProduct.regist]])])]),t("div",Kt,[Qt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入取消政策","onUpdate:modelValue":e[18]||(e[18]=s=>o.tempProduct.canclepolic=s)},`
                    `,512),[[r,o.tempProduct.canclepolic]])]),t("div",Wt,[t("div",Xt,[d(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[19]||(e[19]=s=>o.tempProduct.is_enabled=s),"true-value":1,"false-value":0},null,512),[[_,o.tempProduct.is_enabled]]),Yt])])])])]),t("div",Zt,[te,t("button",{type:"button",class:"btn btn-primary",onClick:e[20]||(e[20]=(...s)=>c.updateProduct&&c.updateProduct(...s))}," 確認 ")])])])],512)}const oe=P($,[["render",ee]]);var se={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:le,VITE_NAME:de}=se,ae={props:["tempProduct","getProducts"],data(){return{delProductModal:null}},methods:{showModal(){this.delProductModal.show()},hideModal(){this.delProductModal.hide()},deleteProduct(){const l=`${le}/api/${de}/admin/product/${this.tempProduct.id}`;U.delete(l,{data:this.tempProduct}).then(e=>{alert(e.data.message),this.hideModal(),this.$emit("update")}).catch(e=>{alert(e.response.data.message)})}},mounted(){this.delProductModal=new M(this.$refs.delProductModal,{keyboard:!1,backdrop:"static"})}},ie={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ne={class:"modal-dialog"},ce={class:"modal-content border-0"},re=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ue={class:"modal-body text-start"},me={class:"text-danger"},pe={class:"fw-bold"},_e=t("div",{class:"mt-2"}," (刪除後將無法恢復)。 ",-1),he={class:"modal-footer"},be=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function fe(l,e,o,g,u,c){return a(),i("div",ie,[t("div",ne,[t("div",ce,[re,t("div",ue,[f(" 是否刪除 "),t("strong",me,[t("span",pe,m(o.tempProduct.title),1)]),f(" 方案 "),_e]),t("div",he,[be,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...s)=>c.deleteProduct&&c.deleteProduct(...s))}," 確認刪除 ")])])])],512)}const ve=P(ae,[["render",fe]]);var Pe={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:ge,VITE_NAME:ye}=Pe,xe={components:{ModalCompanent:oe,ModalDelComponent:ve,Pagination:C},data(){return{products:[],isLoading:!1,fullpage:!1,tempProduct:{imagesUrl:[],minpeople:"",regist:"",schedule:[]},isNew:!1,pagination:{}}},mounted(){this.getProducts()},methods:{getProducts(l=1){this.isLoading=!0;const e=`${ge}/api/${ye}/admin/products?page=${l}`;this.$http.get(e).then(o=>{this.products=o.data.products,this.pagination=o.data.pagination,this.isLoading=!1,T.fire({position:"top-end",icon:"success",title:"成功取得產品資訊",showConfirmButton:!1,timer:1500})}).catch(o=>{console.log(o),this.$router.push("/login")})},openModal(l,e){l==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.modal.showModal()):l==="edit"?(this.tempProduct={...e},this.isNew=!1,this.$refs.modal.showModal()):l==="delete"&&(this.tempProduct={...e},this.$refs.delModal.showModal())},clearInput(){this.tempProduct={imageUrl:[]}},deleteProduct(){const l=`${this.apiUrl}/api/${this.path}/admin/product/${this.tempProduct.id}`;this.$http.delete(l,{data:this.tempProduct}).then(e=>{alert(e.data.message),this.$refs.dModal.closeProduct(),this.getData()}).catch(e=>{alert(e.data.message)})}}},ke={class:"vl-parent"},Me={class:"container"},Ue={class:"row justify-content-between"},Ve=t("h2",{class:"text-primary mb-3 h2 text-start col-6"},"方案列表",-1),we={class:"text-end col-6"},Ee={class:"table table-hover border rounded rounded-3"},Le=t("thead",null,[t("tr",null,[t("th",{scope:"col"}," 上架日期"),t("th",{colspan:"1",scope:"col"},"方案類別"),t("th",{colspan:"1",scope:"col"},"方案標題"),t("th",{colspan:"1",scope:"col"},"原始價格"),t("th",{colspan:"1",scope:"col"},"上線價格"),t("th",{colspan:"1",scope:"col"},"啟用狀態"),t("th",{colspan:"1",scope:"col"},"編輯")])],-1),Ce={scope:"row"},Ie={key:0,class:"text-success"},Ne={key:1},Te={class:"btn-group btn-group-sm"},Re=["onClick"],$e={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ae=["onClick"],De={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function Se(l,e,o,g,u,c){const s=h("VueLoading"),p=h("Pagination"),v=h("ModalCompanent"),E=h("ModalDelComponent");return a(),i("div",ke,[b(s,{active:u.isLoading,"onUpdate:active":e[0]||(e[0]=n=>u.isLoading=n),loader:"bars","is-full-page":u.fullpage},null,8,["active","is-full-page"]),t("div",Me,[t("div",Ue,[Ve,t("div",we,[t("button",{type:"button",class:"btn btn-primary text-white fw-bold",onClick:e[1]||(e[1]=n=>c.openModal("new"))},"新增方案")])]),t("table",Ee,[Le,t("tbody",null,[(a(!0),i(V,null,w(u.products,n=>(a(),i("tr",{key:n.id,class:"align-middle"},[t("th",Ce,m(n.num),1),t("td",null,m(n.category),1),t("td",null,m(n.title),1),t("td",null,"NT$ "+m(n.origin_price)+"/"+m(n.unit),1),t("td",null,"NT$ "+m(n.price)+"/"+m(n.unit),1),t("td",null,[n.is_enabled?(a(),i("span",Ie,"啟用")):(a(),i("span",Ne,"不啟用"))]),t("td",null,[t("div",Te,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:L=>c.openModal("edit",n)},[n.num===0?(a(),i("span",$e)):y("",!0),f(" 編輯內容 ")],8,Re),t("button",{type:"button",class:"btn btn-outline-danger",onClick:L=>c.openModal("delete",n)},[n.num===0?(a(),i("span",De)):y("",!0),f(" 刪除內容 ")],8,Ae)])])]))),128))])]),b(p,{pagination:u.pagination,onEmitPages:c.getProducts},null,8,["pagination","onEmitPages"])]),b(v,{ref:"modal","temp-product":u.tempProduct,"is-new":u.isNew,"clear-input":c.clearInput,onUpdate:c.getProducts},null,8,["temp-product","is-new","clear-input","onUpdate"]),b(E,{ref:"delModal","temp-product":u.tempProduct,onUpdate:c.getProducts},null,8,["temp-product","onUpdate"])])}const ze=P(xe,[["render",Se]]);export{ze as default};

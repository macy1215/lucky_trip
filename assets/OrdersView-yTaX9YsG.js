import{M,P as $}from"./PaginationView-qfqQT_Tw.js";import{_ as v,e as x,o as r,c as n,a as e,t as d,f as _,v as u,i as g,F as b,j as O,n as V,d as f,r as h,b as m}from"./index-C3da9fEV.js";var L={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:U,VITE_NAME:C}=L,D={props:["tempOrder","getOrders"],data(){return{orderEdittModal:null,order:{}}},methods:{showModal(){this.orderEdittModal.show()},hideModal(){this.orderEdittModal.hide()},updateOrder(){const i=`${U}/api/${C}/admin/order/${this.tempOrder.id}`;x["put"](i,{data:this.tempOrder}).then(l=>{alert(l.data.message),this.$emit("update"),this.hideModal(),console.log(this.order,this.tempOrder)}).catch(l=>{alert(l.response.data.message)})}},watch:{tempOrder(){this.order=this.tempOrder}},mounted(){this.orderEdittModal=new M(this.$refs.OrderEditModal,{keyboard:!1,backdrop:"static"})}},T={id:"OrderEditModal",ref:"OrderEditModal",class:"modal fade",tabindex:"-1","aria-labelledby":"OrderEditModal","aria-hidden":"true"},I={class:"modal-dialog modal-xl"},R={class:"modal-content border-0"},P={class:"modal-header bg-dark text-white"},S={id:"OrderEditModal",class:"modal-title"},N=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),A={class:"modal-body text-start"},j={class:"h5 fw-bold"},B={class:"h5 fw-bold"},q=e("hr",null,null,-1),z={class:"row"},F={class:"col-sm-12"},G={class:"row mb-2"},H={key:0,class:"row"},J={class:"col-md-6 mb-4"},K=e("label",{for:"people",class:"form-label"},"訂購人姓名",-1),Q={class:"col-md-6 mb-4"},W=e("label",{for:"people",class:"form-label"},"訂單電話",-1),X={class:"col-md-6 mb-4"},Y=e("label",{for:"people",class:"form-label"},"訂單電子郵件",-1),Z={class:"col-md-6 mb-4"},ee=e("label",{for:"people",class:"form-label"},"訂單電子郵件",-1),te={class:"col-md-12 mb-4"},se=e("label",{for:"people",class:"form-label"},"訂單留言",-1),oe={class:"col-md-12 mb-1"},de=e("label",{for:"people",class:"form-label mb-2"},"付款狀態",-1),le={key:0,class:"text-success"},re={key:1,class:"text-danger fw-bold"},ne=e("hr",null,null,-1),ae={class:"row mt-2"},ie={class:"col-lg-12"},ce={key:0,class:"mb-2"},pe={class:"table table-hover border rounded rounded-3"},_e=e("thead",null,[e("tr",{class:"text-center"},[e("th",{scope:"col"}," 編號"),e("th",{colspan:"1",scope:"col"},"品項圖"),e("th",{colspan:"1",scope:"col"},"品項標題"),e("th",{colspan:"1",scope:"col",class:"text-end"},"品項價格")])],-1),ue={class:"ps-3 py-2 text-center"},he={scope:"row"},me={class:"d-flex justify-content-center"},be={style:{width:"180px"}},ge={class:"text-end"},fe={class:"text-end fw-bold me-2"},Oe={class:"modal-footer"},ve=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ye(i,t,l,y,s,c){return r(),n("div",T,[e("div",I,[e("div",R,[e("div",P,[e("h5",S,[e("span",null,"編輯訂單 "+d(l.tempOrder.id),1)]),N]),e("div",A,[e("div",j,"訂單編號："+d(l.tempOrder.id),1),e("div",B,"訂單日期： "+d(new Date(s.order.create_at*1e3).toLocaleDateString()),1),q,e("div",z,[e("div",F,[e("div",G,[s.order.user?(r(),n("div",H,[e("div",J,[K,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=o=>s.order.user.name=o),disabled:""},null,512),[[u,s.order.user.name]])]),e("div",Q,[W,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=o=>s.order.user.tel=o),disabled:""},null,512),[[u,s.order.user.tel]])]),e("div",X,[Y,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=o=>s.order.user.email=o),disabled:""},null,512),[[u,s.order.user.email]])]),e("div",Z,[ee,_(e("input",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=o=>s.order.user.address=o),disabled:""},null,512),[[u,s.order.user.address]])]),e("div",te,[se,_(e("textarea",{id:"people",type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.order.message=o),disabled:""},`
                              `,512),[[u,s.order.message]])]),e("div",oe,[de,e("div",null,[s.order.is_paid?(r(),n("span",le,"已付款")):(r(),n("span",re,"未付款"))])])])):g("",!0)]),ne,e("div",ae,[e("div",ie,[l.tempOrder&&l.tempOrder.products?(r(),n("div",ce," 訂單內容 ("+d(Object.keys(l.tempOrder.products).length)+") ",1)):g("",!0),e("table",pe,[_e,e("tbody",ue,[(r(!0),n(b,null,O(s.order.products,o=>(r(),n("tr",{key:o.id,class:"align-middle"},[e("th",he,d(Object.keys(s.order.products).length),1),e("td",me,[e("div",be,[e("div",{class:"rounded",style:V([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${o.product.imageUrl})`}])},null,4)])]),e("td",null,d(o.product.title)+" x "+d(o.qty)+" / "+d(o.product.unit),1),e("td",ge,d(o.total)+" 元 ",1)]))),128))])]),e("p",fe,"總金額："+d(s.order.total),1)])])])])]),e("div",Oe,[ve,e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...o)=>c.updateOrder&&c.updateOrder(...o))}," 確認 ")])])])],512)}const Me=v(D,[["render",ye]]);var xe={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_NAME:"lucky_trip",BASE_URL:"/lucky_trip/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Ee,VITE_NAME:ke}=xe,we={props:["tempOrder","getOrders"],data(){return{delOrderModal:null}},methods:{showModal(){this.delOrderModal.show()},hideModal(){this.delOrderModal.hide()},deleteOrder(){const i=`${Ee}/api/${ke}/admin/order/${this.tempOrder.id}`;x.delete(i,{data:this.tempOrder}).then(t=>{alert(t.data.message),this.$emit("update"),this.hideModal()}).catch(t=>{alert(t.response.data.message)})}},mounted(){this.delOrderModal=new M(this.$refs.delOrderModal,{keyboard:!1,backdrop:"static"}),console.log(this.orders)}},$e={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Ve={class:"modal-dialog"},Le={class:"modal-content border-0"},Ue={class:"modal-header bg-danger text-white"},Ce={id:"delProductModalLabel",class:"modal-title"},De=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Te={class:"modal-body text-start"},Ie={class:"text-danger"},Re={class:"fw-bold"},Pe=e("div",{class:"mt-2"}," (刪除後將無法恢復)。 ",-1),Se={class:"modal-footer"},Ne=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ae(i,t,l,y,s,c){return r(),n("div",$e,[e("div",Ve,[e("div",Le,[e("div",Ue,[e("h5",Ce,[e("span",null,"訂單編號"+d(l.tempOrder.id),1)]),De]),e("div",Te,[f(" 是否刪除訂單編號為 "),e("strong",Ie,[e("span",Re,d(l.tempOrder.id),1)]),f(" 訂單？ "),Pe]),e("div",Se,[Ne,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...o)=>c.deleteOrder&&c.deleteOrder(...o))}," 確認刪除 ")])])])],512)}const je=v(we,[["render",Ae]]),Be={components:{OrderEditCompanent:Me,OrdelDelComponent:je,Pagination:$},data(){return{orders:[],tempOrder:{},pagination:{},isLoading:!1}},mounted(){this.getOrders(1)},methods:{getOrders(i=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/lucky_trip/admin/orders?page=${i}`;this.$http.get(t).then(l=>{this.orders=l.data.orders,this.pagination=l.data.pagination,console.log(this.orders),this.isLoading=!1}).catch(l=>{console.log(l)})},openModal(i,t){i==="edit"?(this.tempOrder={...t},this.status=!1,console.log(this.tempOrder),this.$refs.orderEditModal.showModal()):i==="delete"&&(this.tempOrder={...t},console.log(this.tempOrder),this.$refs.delOrderModal.showModal())}}},qe={class:"container"},ze=e("div",{class:"row justify-content-between"},[e("h2",{class:"text-primary mb-3 h2 text-start col-6"},"訂單列表")],-1),Fe={class:"table table-hover border rounded rounded-3 table-responsive"},Ge=e("thead",null,[e("tr",{class:"text-nowrap"},[e("th",{colspan:"1",scope:"col"},"訂單編號"),e("th",{colspan:"1",scope:"col"},"成立時間"),e("th",{colspan:"1",scope:"col"},"訂單內容"),e("th",{colspan:"1",scope:"col"},"訂購人"),e("th",{colspan:"1",scope:"col"},"聯絡電話"),e("th",{colspan:"1",scope:"col"},"合計"),e("th",{colspan:"1",scope:"col"},"付款狀態"),e("th",{colspan:"1",scope:"col"},"編輯")])],-1),He={scope:"row"},Je={class:"ps-0 mb-0"},Ke={key:0,class:"text-success"},Qe={key:1,class:"text-danger"},We={class:"btn-group btn-group-sm"},Xe=["onClick"],Ye={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ze=["onClick"],et={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function tt(i,t,l,y,s,c){const o=h("VueLoading"),E=h("Pagination"),k=h("OrderEditCompanent"),w=h("OrdelDelComponent");return r(),n(b,null,[m(o,{active:s.isLoading,"onUpdate:active":t[0]||(t[0]=a=>s.isLoading=a)},null,8,["active"]),e("div",qe,[ze,e("table",Fe,[Ge,e("tbody",null,[(r(!0),n(b,null,O(s.orders,a=>(r(),n("tr",{key:a.id,class:"align-middle"},[e("th",He,d(a.id),1),e("td",null,d(new Date(a.create_at*1e3).toLocaleDateString()),1),e("td",null,[e("ul",Je,[(r(!0),n(b,null,O(a.products,p=>(r(),n("li",{key:p.product_is},d(p.product.title)+" | "+d(p.qty)+"人",1))),128))])]),e("td",null,d(a.user.name),1),e("td",null,d(a.user.tel),1),e("td",null,d(a.total),1),e("td",null,[a.is_paid?(r(),n("span",Ke,"已付款")):(r(),n("span",Qe,"未付款"))]),e("td",null,[e("div",We,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:p=>c.openModal("edit",a)},[a.num===0?(r(),n("span",Ye)):g("",!0),f(" 編輯 ")],8,Xe),e("button",{type:"button",class:"btn btn-outline-danger",onClick:p=>c.openModal("delete",a)},[a.num===0?(r(),n("span",et)):g("",!0),f(" 刪除 ")],8,Ze)])])]))),128))])]),m(E,{pagination:s.pagination,onEmitPages:c.getOrders},null,8,["pagination","onEmitPages"])]),m(k,{ref:"orderEditModal","temp-order":s.tempOrder,onUpdate:c.getOrders},null,8,["temp-order","onUpdate"]),m(w,{ref:"delOrderModal","temp-order":s.tempOrder,onUpdate:c.getOrders},null,8,["temp-order","onUpdate"])],64)}const dt=v(Be,[["render",tt]]);export{dt as default};
